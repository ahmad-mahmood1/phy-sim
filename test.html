<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morphing Star Animation</title>
    <script type="importmap">
        {
          "imports": {
            "p5": "https://cdn.jsdelivr.net/npm/p5@1.11.3/lib/p5.min.js"
          }
        }
    </script>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #000;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <script type="module">
        import 'p5';

        /**
         * @param {p5} p - The p5.js instance.
         */
        let sketch = function(p) {
            /** @type {number} */
            let points = 5;
            /** @type {number} */
            let innerRadius;
            /** @type {number} */
            let outerRadius;
            /** @type {number} */
            let angle = 0;
            /** @type {number} */
            let angleIncrement = 0.02;
            /** @type {number[]} */
            let targetPointsArray = [];
            /** @type {number} */
            let transitionProgress = 0;
            /** @type {number} */
            let transitionDuration = 60;
            /** @type {boolean} */
            let isTransitioning = false;
            /** @type {number} */
            let timerDuration = 5000;
            /** @type {number} */
            let lastPointChangeTime = 0;

            /**
             * Setup function for p5.js.
             * Initializes the canvas, background, and initial star parameters.
             */
            p.setup = function() {
                p.createCanvas(800, 600);
                p.background('#000000');
                innerRadius = p.width / 10;
                outerRadius = p.width / 3;
                lastPointChangeTime = p.millis();
                generateNewTargetPoints();
            };

            /**
             * Draw function for p5.js.
             * Clears the background and draws the morphing star.
             */
            p.draw = function() {
                p.background('#000000');

                if (!isTransitioning && p.millis() - lastPointChangeTime > timerDuration) {
                    generateNewTargetPoints();
                    isTransitioning = true;
                    transitionProgress = 0;
                    lastPointChangeTime = p.millis();
                }

                if (isTransitioning) {
                    transitionProgress += 1 / transitionDuration;
                    if (transitionProgress >= 1) {
                        isTransitioning = false;
                        transitionProgress = 0;
                        points = targetPointsArray[0];
                    }
                }

                let currentPoints = isTransitioning
                    ? p.lerp(points, targetPointsArray[0], transitionProgress)
                    : points;

                p.translate(p.width / 2, p.height / 2);
                p.rotate(angle);
                p.noFill();
                p.stroke('#FFD700');
                p.strokeWeight(2);

                p.beginShape();
                for (let i = 0; i < currentPoints * 2; i++) {
                    let radius = i % 2 === 0 ? outerRadius : innerRadius;
                    let a = p.TWO_PI / (currentPoints * 2) * i;
                    let x = p.cos(a) * radius;
                    let y = p.sin(a) * radius;
                    p.vertex(x, y);
                }
                p.endShape(p.CLOSE);

                angle += angleIncrement;
            };

            /**
             * Generates new random target points for the star morphing effect.
             * Selects a random number of points and creates a smooth transition array.
             */
            function generateNewTargetPoints() {
                let newPoints;
                do {
                    newPoints = p.floor(p.random(5, 13));
                } while (newPoints === points);

                // Create a smooth transition array
                targetPointsArray = [];
                for (let i = 1; i <= 20; i++) {
                    targetPointsArray.push(p.lerp(points, newPoints, i / 20));
                }
            }
        };

        let myp5 = new window.p5(sketch);
    </script>
</body>
</html>